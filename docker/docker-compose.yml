# GoStrike Docker Compose
# CS2 dedicated server with Metamod + GoStrike plugin development environment

services:
  cs2-server:
    image: joedwards32/cs2
    container_name: gostrike-cs2
    user: root
    ports:
      - "27015:27015/tcp"
      - "27015:27015/udp"
      - "27020:27020/udp"
      - "8080:8080/tcp"
    environment:
      # Development server settings (LAN mode, no token needed)
      - CS2_SERVERNAME=GoStrike Dev Server
      - CS2_PORT=27015
      - CS2_RCONPW=gostrike
      - CS2_PW=
      - CS2_MAXPLAYERS=10
      - CS2_GAMETYPE=0
      - CS2_GAMEMODE=1
      - CS2_MAPGROUP=mg_active
      - CS2_STARTMAP=de_dust2
      - CS2_LAN=1
      - CS2_SERVER_HIBERNATE=0
    volumes:
      # Bind mount for CS2 installation (~60GB) - more reliable than Docker volumes
      - ./data/cs2:/home/steam/cs2-dedicated
      # Mount pre.sh hook for startup customization
      - ./scripts/pre.sh:/home/steam/cs2-dedicated/pre.sh:ro
    restart: unless-stopped
    stdin_open: true
    tty: true

networks:
  default:
    name: gostrike-net
